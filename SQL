 # 1
SELECT p.FullName, p.PhoneNumber AS Personal_Phone_Number, p.FaxNumber AS Personal_Fax_Number, 
COALESCE(c.PhoneNumber, s.PhoneNumber) AS Company_Phone_Number, COALESCE(c.FaxNumber, s.FaxNumber) AS Company_Fax_Number
FROM Application.People p
LEFT JOIN Sales.Customers c 
ON (p.PersonID = c.PrimaryContactPersonID) OR (p.PersonID = c.AlternateContactPersonID)
LEFT JOIN Purchasing.Suppliers s 
ON (p.PersonID = s.PrimaryContactPersonID) OR (p.PersonID = s.AlternateContactPersonID);

# 2
SELECT c.CustomerName
FROM Application.People p
INNER JOIN Sales.Customers c
ON (p.PersonID = c.PrimaryContactPersonID) AND (p.PhoneNumber = c.PhoneNumber);

# 3
SELECT c.CustomerName, ct.TransactionDate
FROM Sales.Customers c
INNER JOIN Sales.CustomerTransactions ct
ON c.CustomerID = ct.CustomerID
WHERE ct.TransactionDate < '2016-01-01' 
AND ct.CustomerID NOT IN 
(SELECT distinct ct.CustomerID
FROM Sales.CustomerTransactions ct
WHERE ct.TransactionDate > '2016-01-01');

# 4
SELECT s.StockItemName, SUM(s.QuantityPerOuter) as total_quantity
FROM Warehouse.StockItems s
INNER JOIN Purchasing.PurchaseOrderLines p
ON s.StockItemID = p.StockItemID
WHERE YEAR(p.LastReceiptDate)=2013
GROUP BY s.StockItemName;

# 5
SELECT DISTINCT s.StockItemName
FROM Warehouse.StockItems s
INNER JOIN Purchasing.PurchaseOrderLines p
ON s.StockItemID = p.StockItemID
WHERE LEN(p.Description) >= 10;

# 6
SELECT DISTINCT s.StockItemName
FROM Warehouse.StockItems s
INNER JOIN Application.People p
ON s.LastEditedBy = p.PersonID
INNER JOIN Application.StateProvinces sp
ON p.PersonID = sp.LastEditedBy
INNER JOIN Purchasing.PurchaseOrderLines po
ON s.StockItemID = po.StockItemID
WHERE YEAR(po.LastReceiptDate)=2014 AND
sp.StateProvinceName != 'Alabama' OR sp.StateProvinceName != 'Georgia';
